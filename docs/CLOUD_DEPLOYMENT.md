# Cloud Deployment Guide

This guide provides step-by-step instructions for deploying the EnnovateX AI Platform to various cloud providers.

## Table of Contents

- [Vercel (Frontend)](#vercel-frontend)
- [Railway (Backend)](#railway-backend)
- [Render (Backend Alternative)](#render-backend-alternative)
- [AWS Deployment](#aws-deployment)
- [Google Cloud Platform](#google-cloud-platform)
- [Azure Deployment](#azure-deployment)
- [Environment Variables](#environment-variables)
- [Domain Configuration](#domain-configuration)
- [Monitoring Setup](#monitoring-setup)

## Vercel (Frontend)

### Prerequisites
- GitHub account
- Vercel account
- Repository pushed to GitHub

### Deployment Steps

#### 1. Install Vercel CLI (Optional)
```bash
npm i -g vercel
vercel login
```

#### 2. Deploy via Vercel Dashboard

1. **Connect Repository**:
   - Go to [Vercel Dashboard](https://vercel.com/dashboard)
   - Click "New Project"
   - Import your GitHub repository
   - Select the root directory (not backend)

2. **Configure Build Settings**:
   - Framework Preset: `Next.js`
   - Build Command: `npm run build`
   - Output Directory: `.next`
   - Install Command: `npm install`

3. **Environment Variables**:
   ```
   NEXT_PUBLIC_API_URL=https://your-backend-url.com
   NEXT_PUBLIC_APP_URL=https://your-frontend-url.vercel.app
   NEXT_PUBLIC_ENVIRONMENT=production
   NEXT_PUBLIC_ANALYTICS_ID=your-analytics-id
   NEXT_PUBLIC_SENTRY_DSN=your-sentry-dsn
   ```

4. **Deploy**:
   - Click "Deploy"
   - Wait for build completion
   - Your app will be available at `https://your-project.vercel.app`

#### 3. Custom Domain Setup

1. **Add Domain**:
   - Go to Project Settings > Domains
   - Add your custom domain
   - Configure DNS records as instructed

2. **SSL Certificate**:
   - Vercel automatically provisions SSL certificates
   - No additional configuration needed

#### 4. Vercel CLI Deployment

```bash
# From project root
vercel

# For production deployment
vercel --prod

# Set environment variables
vercel env add NEXT_PUBLIC_API_URL
vercel env add NEXT_PUBLIC_APP_URL
```

### Vercel Configuration

The `vercel.json` file is already configured with:
- Security headers
- CORS settings
- Redirects and rewrites
- Function timeouts

## Railway (Backend)

### Prerequisites
- GitHub account
- Railway account
- Repository pushed to GitHub

### Deployment Steps

#### 1. Create Railway Project

1. **Connect Repository**:
   - Go to [Railway Dashboard](https://railway.app/dashboard)
   - Click "New Project"
   - Select "Deploy from GitHub repo"
   - Choose your repository

2. **Configure Service**:
   - Select the `backend` directory as root
   - Railway will auto-detect the Dockerfile

#### 2. Add Database Services

1. **PostgreSQL**:
   - Click "New" > "Database" > "PostgreSQL"
   - Note the connection details

2. **Redis**:
   - Click "New" > "Database" > "Redis"
   - Note the connection details

#### 3. Environment Variables

In Railway dashboard, add these variables:

```bash
# Application
ENVIRONMENT=production
DEBUG=false
LOG_LEVEL=info

# Database (auto-generated by Railway)
DATABASE_URL=${{Postgres.DATABASE_URL}}
REDIS_URL=${{Redis.REDIS_URL}}

# Security
SECRET_KEY=your-secret-key
JWT_SECRET_KEY=your-jwt-secret

# AI Services
HUGGINGFACE_API_KEY=your-huggingface-key
OPENAI_API_KEY=your-openai-key

# CORS
CORS_ORIGINS=https://your-frontend-domain.com
ALLOWED_HOSTS=your-backend-domain.railway.app

# File Upload
UPLOAD_DIR=/app/uploads
MAX_FILE_SIZE=50MB

# Monitoring
SENTRY_DSN=your-sentry-dsn
```

#### 4. Custom Domain

1. **Add Domain**:
   - Go to Service Settings > Networking
   - Add custom domain
   - Configure DNS CNAME record

2. **SSL Certificate**:
   - Railway automatically provisions SSL

#### 5. Railway CLI (Optional)

```bash
# Install Railway CLI
npm install -g @railway/cli

# Login
railway login

# Deploy
railway up

# Set environment variables
railway variables set SECRET_KEY=your-secret-key
```

## Render (Backend Alternative)

### Prerequisites
- GitHub account
- Render account
- Repository pushed to GitHub

### Deployment Steps

#### 1. Create Web Service

1. **Connect Repository**:
   - Go to [Render Dashboard](https://dashboard.render.com)
   - Click "New" > "Web Service"
   - Connect your GitHub repository

2. **Configure Service**:
   - Name: `ennovatex-api`
   - Region: Choose closest to your users
   - Branch: `main`
   - Root Directory: `backend`
   - Runtime: `Docker`
   - Build Command: (leave empty for Docker)
   - Start Command: `uvicorn app.main:app --host 0.0.0.0 --port $PORT --workers 4`

#### 2. Add Database Services

1. **PostgreSQL**:
   - Click "New" > "PostgreSQL"
   - Name: `ennovatex-postgres`
   - Plan: Choose appropriate plan
   - Note the connection string

2. **Redis**:
   - Click "New" > "Redis"
   - Name: `ennovatex-redis`
   - Plan: Choose appropriate plan
   - Note the connection string

#### 3. Environment Variables

Add in Render dashboard:

```bash
# Application
ENVIRONMENT=production
DEBUG=false
LOG_LEVEL=info

# Database
DATABASE_URL=postgresql://user:pass@host:port/db
REDIS_URL=redis://user:pass@host:port

# Security
SECRET_KEY=your-secret-key
JWT_SECRET_KEY=your-jwt-secret

# AI Services
HUGGINGFACE_API_KEY=your-huggingface-key
OPENAI_API_KEY=your-openai-key

# CORS
CORS_ORIGINS=https://your-frontend-domain.com
ALLOWED_HOSTS=your-service.onrender.com
```

#### 4. Custom Domain

1. **Add Domain**:
   - Go to Service Settings > Custom Domains
   - Add your domain
   - Configure DNS CNAME record

2. **SSL Certificate**:
   - Render automatically provisions SSL

## AWS Deployment

### Option 1: AWS App Runner

#### Frontend (App Runner + S3)

```bash
# Build for production
npm run build
npm run export

# Upload to S3
aws s3 sync out/ s3://your-bucket-name --delete

# Configure CloudFront distribution
aws cloudfront create-distribution --distribution-config file://cloudfront-config.json
```

#### Backend (App Runner)

1. **Create App Runner Service**:
   - Source: Container registry
   - Container image URI: Your ECR repository
   - Port: 8000
   - Environment variables: Set as needed

### Option 2: ECS Fargate

#### 1. Build and Push Images

```bash
# Build and push frontend
docker build -t your-account.dkr.ecr.region.amazonaws.com/ennovatex-frontend .
docker push your-account.dkr.ecr.region.amazonaws.com/ennovatex-frontend

# Build and push backend
cd backend
docker build -t your-account.dkr.ecr.region.amazonaws.com/ennovatex-backend .
docker push your-account.dkr.ecr.region.amazonaws.com/ennovatex-backend
```

#### 2. Create ECS Services

```bash
# Create cluster
aws ecs create-cluster --cluster-name ennovatex-cluster

# Create task definitions
aws ecs register-task-definition --cli-input-json file://frontend-task-def.json
aws ecs register-task-definition --cli-input-json file://backend-task-def.json

# Create services
aws ecs create-service --cluster ennovatex-cluster --service-name frontend --task-definition frontend
aws ecs create-service --cluster ennovatex-cluster --service-name backend --task-definition backend
```

### Database Services

- **RDS PostgreSQL**: Managed PostgreSQL database
- **ElastiCache Redis**: Managed Redis cache
- **S3**: File storage for uploads

## Google Cloud Platform

### Cloud Run Deployment

#### 1. Build and Deploy Frontend

```bash
# Build image
gcloud builds submit --tag gcr.io/PROJECT_ID/ennovatex-frontend

# Deploy to Cloud Run
gcloud run deploy ennovatex-frontend \
  --image gcr.io/PROJECT_ID/ennovatex-frontend \
  --platform managed \
  --region us-central1 \
  --allow-unauthenticated
```

#### 2. Build and Deploy Backend

```bash
# Build image
cd backend
gcloud builds submit --tag gcr.io/PROJECT_ID/ennovatex-backend

# Deploy to Cloud Run
gcloud run deploy ennovatex-backend \
  --image gcr.io/PROJECT_ID/ennovatex-backend \
  --platform managed \
  --region us-central1 \
  --allow-unauthenticated \
  --set-env-vars="DATABASE_URL=postgresql://...,REDIS_URL=redis://..."
```

### Database Services

- **Cloud SQL PostgreSQL**: Managed PostgreSQL
- **Memorystore Redis**: Managed Redis
- **Cloud Storage**: File storage

## Azure Deployment

### Container Instances

#### 1. Create Resource Group

```bash
az group create --name ennovatex-rg --location eastus
```

#### 2. Deploy Frontend

```bash
az container create \
  --resource-group ennovatex-rg \
  --name ennovatex-frontend \
  --image your-registry/ennovatex-frontend \
  --dns-name-label ennovatex-frontend \
  --ports 3000
```

#### 3. Deploy Backend

```bash
az container create \
  --resource-group ennovatex-rg \
  --name ennovatex-backend \
  --image your-registry/ennovatex-backend \
  --dns-name-label ennovatex-backend \
  --ports 8000 \
  --environment-variables DATABASE_URL=postgresql://... REDIS_URL=redis://...
```

### Database Services

- **Azure Database for PostgreSQL**: Managed PostgreSQL
- **Azure Cache for Redis**: Managed Redis
- **Azure Blob Storage**: File storage

## Environment Variables

### Frontend Environment Variables

```bash
# Required
NEXT_PUBLIC_API_URL=https://your-backend-url.com
NEXT_PUBLIC_APP_URL=https://your-frontend-url.com
NEXT_PUBLIC_ENVIRONMENT=production

# Optional
NEXT_PUBLIC_ANALYTICS_ID=your-analytics-id
NEXT_PUBLIC_SENTRY_DSN=your-sentry-dsn
NEXT_PUBLIC_HOTJAR_ID=your-hotjar-id
NEXT_PUBLIC_INTERCOM_APP_ID=your-intercom-id
```

### Backend Environment Variables

```bash
# Application
ENVIRONMENT=production
DEBUG=false
LOG_LEVEL=info
PORT=8000

# Database
DATABASE_URL=postgresql://user:pass@host:port/db
REDIS_URL=redis://user:pass@host:port

# Security
SECRET_KEY=your-secret-key
JWT_SECRET_KEY=your-jwt-secret
JWT_ALGORITHM=HS256
JWT_EXPIRE_MINUTES=30

# CORS
CORS_ORIGINS=https://your-frontend-domain.com
ALLOWED_HOSTS=your-backend-domain.com

# AI Services
HUGGINGFACE_API_KEY=your-huggingface-key
OPENAI_API_KEY=your-openai-key

# File Upload
UPLOAD_DIR=/app/uploads
MAX_FILE_SIZE=50MB
ALLOWED_EXTENSIONS=.txt,.pdf,.doc,.docx

# Monitoring
SENTRY_DSN=your-sentry-dsn
PROMETHEUS_ENABLED=true

# Email (Optional)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
```

## Domain Configuration

### DNS Records

#### Frontend Domain
```
Type: CNAME
Name: www
Value: your-project.vercel.app

Type: A
Name: @
Value: 76.76.19.61 (Vercel IP)
```

#### Backend Domain
```
Type: CNAME
Name: api
Value: your-service.railway.app
```

### SSL Certificates

Most cloud providers (Vercel, Railway, Render) automatically provision SSL certificates. For custom setups:

```bash
# Let's Encrypt with Certbot
sudo certbot --nginx -d yourdomain.com -d www.yourdomain.com
```

## Monitoring Setup

### Sentry Error Tracking

1. **Create Sentry Project**:
   - Go to [Sentry.io](https://sentry.io)
   - Create new project for React and Python
   - Get DSN URLs

2. **Configure Frontend**:
   ```bash
   NEXT_PUBLIC_SENTRY_DSN=https://your-dsn@sentry.io/project-id
   ```

3. **Configure Backend**:
   ```bash
   SENTRY_DSN=https://your-dsn@sentry.io/project-id
   ```

### Analytics

#### Google Analytics
```bash
NEXT_PUBLIC_GA_ID=G-XXXXXXXXXX
```

#### Hotjar
```bash
NEXT_PUBLIC_HOTJAR_ID=your-hotjar-id
```

### Uptime Monitoring

- **UptimeRobot**: Free uptime monitoring
- **Pingdom**: Advanced monitoring
- **StatusPage**: Status page for users

## Deployment Checklist

### Pre-Deployment
- [ ] Environment variables configured
- [ ] Database migrations ready
- [ ] SSL certificates configured
- [ ] Domain DNS configured
- [ ] Monitoring setup
- [ ] Backup strategy in place

### Post-Deployment
- [ ] Health checks passing
- [ ] Frontend accessible
- [ ] API endpoints working
- [ ] Database connections working
- [ ] File uploads working
- [ ] Error tracking working
- [ ] Performance monitoring active

### Security
- [ ] HTTPS enforced
- [ ] Security headers configured
- [ ] CORS properly configured
- [ ] Rate limiting enabled
- [ ] Secrets properly managed
- [ ] Database access restricted

## Troubleshooting

### Common Issues

#### Build Failures
```bash
# Check build logs
vercel logs
railway logs

# Local build test
npm run build
docker build -t test .
```

#### Environment Variable Issues
```bash
# Verify variables are set
echo $NEXT_PUBLIC_API_URL
echo $DATABASE_URL

# Check in application
console.log(process.env.NEXT_PUBLIC_API_URL)
```

#### Database Connection Issues
```bash
# Test database connection
psql $DATABASE_URL
redis-cli -u $REDIS_URL
```

#### CORS Issues
```bash
# Check CORS configuration
curl -H "Origin: https://your-frontend.com" \
     -H "Access-Control-Request-Method: POST" \
     -H "Access-Control-Request-Headers: X-Requested-With" \
     -X OPTIONS \
     https://your-api.com/api/endpoint
```

### Support Resources

- **Vercel**: [Documentation](https://vercel.com/docs)
- **Railway**: [Documentation](https://docs.railway.app)
- **Render**: [Documentation](https://render.com/docs)
- **AWS**: [Documentation](https://docs.aws.amazon.com)
- **GCP**: [Documentation](https://cloud.google.com/docs)
- **Azure**: [Documentation](https://docs.microsoft.com/azure)

---

**Last Updated**: $(date +%Y-%m-%d)
**Version**: 1.0.0